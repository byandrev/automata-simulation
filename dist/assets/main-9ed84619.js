import{r as ee,a as Ee,i as we,l as te,s as Le,C as Oe,c as Ae,d as De,b as K,F as ke,e as Me,f as Ce}from"./download-b8e6c2a9.js";var S=typeof window<"u"?window:null,re=S===null,U=re?void 0:S.document,p="addEventListener",z="removeEventListener",Q="getBoundingClientRect",G="_a",b="_b",L="_c",P="horizontal",x=function(){return!1},Ne=re?"calc":["","-webkit-","-moz-","-o-"].filter(function(s){var i=U.createElement("div");return i.style.cssText="width:"+s+"calc(9px)",!!i.style.length}).shift()+"calc",ce=function(s){return typeof s=="string"||s instanceof String},ue=function(s){if(ce(s)){var i=U.querySelector(s);if(!i)throw new Error("Selector "+s+" did not match a DOM element");return i}return s},d=function(s,i,a){var o=s[i];return o!==void 0?o:a},H=function(s,i,a,o){if(i){if(o==="end")return 0;if(o==="center")return s/2}else if(a){if(o==="start")return 0;if(o==="center")return s/2}return s},qe=function(s,i){var a=U.createElement("div");return a.className="gutter gutter-"+i,a},Fe=function(s,i,a){var o={};return ce(i)?o[s]=i:o[s]=Ne+"("+i+"% - "+a+"px)",o},Ie=function(s,i){var a;return a={},a[s]=i+"px",a},Ge=function(s,i){if(i===void 0&&(i={}),re)return{};var a=s,o,h,E,y,m,u;Array.from&&(a=Array.from(a));var l=ue(a[0]),v=l.parentNode,w=getComputedStyle?getComputedStyle(v):null,C=w?w.flexDirection:null,O=d(i,"sizes")||a.map(function(){return 100/a.length}),A=d(i,"minSize",100),T=Array.isArray(A)?A:a.map(function(){return A}),X=d(i,"maxSize",1/0),fe=Array.isArray(X)?X:a.map(function(){return X}),de=d(i,"expandToMin",!1),F=d(i,"gutterSize",10),j=d(i,"gutterAlign","center"),Y=d(i,"snapOffset",30),ve=Array.isArray(Y)?Y:a.map(function(){return Y}),Z=d(i,"dragInterval",1),N=d(i,"direction",P),$=d(i,"cursor",N===P?"col-resize":"row-resize"),me=d(i,"gutter",qe),ne=d(i,"elementStyle",Fe),ge=d(i,"gutterStyle",Ie);N===P?(o="width",h="clientX",E="left",y="right",m="clientWidth"):N==="vertical"&&(o="height",h="clientY",E="top",y="bottom",m="clientHeight");function I(r,e,t,n){var f=ne(o,e,t,n);Object.keys(f).forEach(function(c){r.style[c]=f[c]})}function he(r,e,t){var n=ge(o,e,t);Object.keys(n).forEach(function(f){r.style[f]=n[f]})}function B(){return u.map(function(r){return r.size})}function ie(r){return"touches"in r?r.touches[0][h]:r[h]}function ae(r){var e=u[this.a],t=u[this.b],n=e.size+t.size;e.size=r/this.size*n,t.size=n-r/this.size*n,I(e.element,e.size,this[b],e.i),I(t.element,t.size,this[L],t.i)}function Se(r){var e,t=u[this.a],n=u[this.b];this.dragging&&(e=ie(r)-this.start+(this[b]-this.dragOffset),Z>1&&(e=Math.round(e/Z)*Z),e<=t.minSize+t.snapOffset+this[b]?e=t.minSize+this[b]:e>=this.size-(n.minSize+n.snapOffset+this[L])&&(e=this.size-(n.minSize+this[L])),e>=t.maxSize-t.snapOffset+this[b]?e=t.maxSize+this[b]:e<=this.size-(n.maxSize-n.snapOffset+this[L])&&(e=this.size-(n.maxSize+this[L])),ae.call(this,e),d(i,"onDrag",x)(B()))}function se(){var r=u[this.a].element,e=u[this.b].element,t=r[Q](),n=e[Q]();this.size=t[o]+n[o]+this[b]+this[L],this.start=t[E],this.end=t[y]}function ye(r){if(!getComputedStyle)return null;var e=getComputedStyle(r);if(!e)return null;var t=r[m];return t===0?null:(N===P?t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight):t-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),t)}function le(r){var e=ye(v);if(e===null||T.reduce(function(c,g){return c+g},0)>e)return r;var t=0,n=[],f=r.map(function(c,g){var M=e*c/100,_=H(F,g===0,g===r.length-1,j),R=T[g]+_;return M<R?(t+=R-M,n.push(0),R):(n.push(M-R),M)});return t===0?r:f.map(function(c,g){var M=c;if(t>0&&n[g]-t>0){var _=Math.min(t,n[g]-t);t-=_,M=c-_}return M/e*100})}function pe(){var r=this,e=u[r.a].element,t=u[r.b].element;r.dragging&&d(i,"onDragEnd",x)(B()),r.dragging=!1,S[z]("mouseup",r.stop),S[z]("touchend",r.stop),S[z]("touchcancel",r.stop),S[z]("mousemove",r.move),S[z]("touchmove",r.move),r.stop=null,r.move=null,e[z]("selectstart",x),e[z]("dragstart",x),t[z]("selectstart",x),t[z]("dragstart",x),e.style.userSelect="",e.style.webkitUserSelect="",e.style.MozUserSelect="",e.style.pointerEvents="",t.style.userSelect="",t.style.webkitUserSelect="",t.style.MozUserSelect="",t.style.pointerEvents="",r.gutter.style.cursor="",r.parent.style.cursor="",U.body.style.cursor=""}function ze(r){if(!("button"in r&&r.button!==0)){var e=this,t=u[e.a].element,n=u[e.b].element;e.dragging||d(i,"onDragStart",x)(B()),r.preventDefault(),e.dragging=!0,e.move=Se.bind(e),e.stop=pe.bind(e),S[p]("mouseup",e.stop),S[p]("touchend",e.stop),S[p]("touchcancel",e.stop),S[p]("mousemove",e.move),S[p]("touchmove",e.move),t[p]("selectstart",x),t[p]("dragstart",x),n[p]("selectstart",x),n[p]("dragstart",x),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.MozUserSelect="none",t.style.pointerEvents="none",n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.MozUserSelect="none",n.style.pointerEvents="none",e.gutter.style.cursor=$,e.parent.style.cursor=$,U.body.style.cursor=$,se.call(e),e.dragOffset=ie(r)-e.end}}O=le(O);var k=[];u=a.map(function(r,e){var t={element:ue(r),size:O[e],minSize:T[e],maxSize:fe[e],snapOffset:ve[e],i:e},n;if(e>0&&(n={a:e-1,b:e,dragging:!1,direction:N,parent:v},n[b]=H(F,e-1===0,!1,j),n[L]=H(F,!1,e===a.length-1,j),C==="row-reverse"||C==="column-reverse")){var f=n.a;n.a=n.b,n.b=f}if(e>0){var c=me(e,N,t.element);he(c,F,e),n[G]=ze.bind(n),c[p]("mousedown",n[G]),c[p]("touchstart",n[G]),v.insertBefore(c,t.element),n.gutter=c}return I(t.element,t.size,H(F,e===0,e===a.length-1,j),e),e>0&&k.push(n),t});function oe(r){var e=r.i===k.length,t=e?k[r.i-1]:k[r.i];se.call(t);var n=e?t.size-r.minSize-t[L]:r.minSize+t[b];ae.call(t,n)}u.forEach(function(r){var e=r.element[Q]()[o];e<r.minSize&&(de?oe(r):r.minSize=e)});function be(r){var e=le(r);e.forEach(function(t,n){if(n>0){var f=k[n-1],c=u[f.a],g=u[f.b];c.size=e[n-1],g.size=t,I(c.element,c.size,f[b],c.i),I(g.element,g.size,f[L],g.i)}})}function xe(r,e){k.forEach(function(t){if(e!==!0?t.parent.removeChild(t.gutter):(t.gutter[z]("mousedown",t[G]),t.gutter[z]("touchstart",t[G])),r!==!0){var n=ne(o,t.a.size,t[b]);Object.keys(n).forEach(function(f){u[t.a].element.style[f]="",u[t.b].element.style[f]=""})}})}return{setSizes:be,getSizes:B,collapse:function(e){oe(u[e])},destroy:xe,parent:v,pairs:k}};function Ue(s,i,a,o){const h=[],E=(l,v,w)=>{if(w.length<=0)return l.finalStates.includes(v);for(let C=0;C<l.transitions[v].length;C++){const[O,A]=l.transitions[v][C];if(A===w[0]){if(h.push([v,A,O,w[0]]),E(l,O,w.slice(1)))return!0}else if(A==="λ"&&(h.push([v,A,O,w[0]]),E(l,O,w)))return!0}return!1},y=E(a,a.initialState,o);let m=0;document.querySelector("#string-out").textContent="";const u=setInterval(()=>{if(m>=h.length){y?ee("VALID"):ee("INVALID"),clearInterval(u);return}const l=h[m];Ee(s,i,l[0],l[1],a.finalStates.includes(l[0]),l[2]),m++},1e3);return y}const{graph:q,paper:J}=we(),je=document.querySelector("#input-string"),V=document.querySelector("#input-label-name"),W=document.querySelector("#input-state-name"),Be=document.querySelector("#btn-clear-all"),_e=document.querySelector("#btn-download"),D=Ce();function Re(){const s=q.toJSON(),i=J.model.getElements(),a={},o=[],h=[],E=je.value,y=[],m={};if(K(null),i.forEach(l=>{l.attributes.type==="Circle"&&(a[l.attributes.id]={text:l.attributes.attrs.label.text,id:l.attributes.id},m[l.attributes.attrs.label.text]={},l.attributes.attrs.body.fill===ke&&o.push(l.attributes.attrs.label.text))}),s.cells.forEach(l=>{l.type==="Link"&&(h.push(...l.labels[0].attrs.text.text.split(",")),l.labels[0].attrs.text.text.split(",").forEach(v=>{m[a[l.source.id].text].length>=0?m[a[l.source.id].text].push([a[l.target.id].text,v]):m[a[l.source.id].text]=[[a[l.target.id].text,v]]}))}),Object.values(a).forEach(l=>y.push(l.text)),y.length<=0){K("No states");return}if(!y.includes("q0")){K("Initial state not found: q0");return}D.alphabet=h,D.initialState="q0",D.states=y,D.finalStates=o,D.transitions=m,console.log(D),ee("Loading ..."),Me(E);const u=Ue(J,q,D,E);console.log(u)}function Pe(){const s=V.getAttribute("link-id");q.getLinks().find(a=>a.id===s).label(0,{attrs:{text:{text:V.value||"λ"}}}),V.value="",te.close("modal-label-name")}function He(){const s=W.getAttribute("state-id"),i=J.model.getElements().find(a=>a.id===s);i&&i.attr("label/text",W.value),W.value="",te.close("modal-state-name")}window.addEventListener("DOMContentLoaded",()=>{te.init(),Ge(["#paper","#split-1"],{sizes:[80,20],minSize:300}),Le(q),new Oe({position:{x:50,y:250},attrs:{label:{text:"q0"}}}).addTo(q),document.querySelector("#run").addEventListener("click",Re)});window.addEventListener("resize",()=>{J.setDimensions(document.body.clientWidth)});V.addEventListener("keydown",s=>{s.code==="Enter"&&Pe()});W.addEventListener("keydown",s=>{s.code==="Enter"&&He()});Be.addEventListener("click",()=>{Ae(D),q.clear()});_e.addEventListener("click",De);
