import{i as D,l as E,s as O,C as M,c as R,d as F,a as H,F as _,f as j}from"./download-b8e6c2a9.js";const{graph:g,paper:S}=D(),A=document.querySelector("#input-string"),h=document.querySelector("#input-label-name"),m=document.querySelector("#input-state-name"),z=document.querySelector("#btn-clear-all"),G=document.querySelector("#btn-download"),J=document.querySelector("#btn-load"),W=document.querySelector("#btn-run"),i=document.querySelectorAll("#tape > .tape-item");let s=Array(200).fill(""),o=parseInt(s.length/2),x=!1;const u=j();function B(){const e=[];x=!0;let t=Array(200).fill(""),r=parseInt(t.length/2),p=A.value;o=parseInt(s.length/2),L(p,t),L(p,s);const d=l=>{let f=l.initialState,I="";if(l.finalStates.includes(f))return!0;let T=0;for(;!l.finalStates.includes(f)&&T<100;){I=t[r];const v=f?l.transitions[f].filter(b=>b[1]==I):[];if(v&&v.length===1){const[b,N,k,q]=v[0];e.push([f,N,b,t[r],k,q]),w(q,t,r),k==="R"?r++:r--,f=b}else break;T++}};x=!1;const c=d(u);console.log("Resultado: "+c),console.log(e),console.log("Tape: "),console.log(t),console.log("Head: ",r);let a=0;const y=setInterval(()=>{if(a>=e.length){x=!1,clearInterval(y);return}const l=e[a];console.log(l),w(l[5],s,o),P(l[4]==="R"?"right":"left"),C(s,o),console.log("Head => ",o),console.log(s),H(S,g,l[0],l[1],u.finalStates.includes(l[0]),l[2]),a++},1e3)}function L(n,e){o=parseInt(e.length/2),V(),C(e,o);for(let t=0;t<n.length;t++)e[o+t]=n[t];for(let t=0;t<e.length&&t+5<i.length;t++)i[t+5].textContent=e[o+t]}function K(){const n=g.toJSON(),e=S.model.getElements(),t={},r=[],p=[],d=[],c={};if(e.forEach(a=>{a.attributes.type==="Circle"&&(t[a.attributes.id]={text:a.attributes.attrs.label.text,id:a.attributes.id},c[a.attributes.attrs.label.text]={},a.attributes.attrs.body.fill===_&&r.push(a.attributes.attrs.label.text))}),n.cells.forEach(a=>{a.type==="Link"&&(p.push(...a.labels[0].attrs.text.text.split(",")),a.labels[0].attrs.text.text.split(",").forEach(y=>{const l=y.split(";");if(l.length<3){alert("Connection error");return}c[t[a.source.id].text].length>=0?c[t[a.source.id].text].push([t[a.target.id].text,l[0],l[1],l[2]]):c[t[a.source.id].text]=[[t[a.target.id].text,l[0],l[1],l[2]]]}))}),Object.values(t).forEach(a=>d.push(a.text)),d.length<=0){alert("NO states");return}if(!d.includes("q0")){alert("Initial state not found: q0");return}u.alphabet=p,u.initialState="q0",u.states=d,u.finalStates=r,u.transitions=c}function P(n="right"){n==="right"?o+=1:o-=1;for(let e=0;e<s.length&&e<i.length;e++)i[e].textContent=s[o+e-5]}function w(n,e,t){e[t]=n}function C(n,e){for(let t=0;t<n.length&&t<i.length;t++)i[t].textContent=n[e+t-5]}function Q(){const n=h.getAttribute("link-id");g.getLinks().find(t=>t.id===n).label(0,{attrs:{text:{text:h.value||"Î»"}}}),h.value="",E.close("modal-label-name")}function U(){const n=m.getAttribute("state-id"),e=S.model.getElements().find(t=>t.id===n);e&&e.attr("label/text",m.value),m.value="",E.close("modal-state-name")}function V(){for(let n=0;n<i.length;n++)i[n].textContent=""}window.addEventListener("DOMContentLoaded",()=>{E.init(),O(g),new M({position:{x:50,y:250},attrs:{label:{text:"q0"}}}).addTo(g)});window.addEventListener("resize",()=>{S.setDimensions(document.body.clientWidth)});h.addEventListener("keydown",n=>{n.code==="Enter"&&Q()});m.addEventListener("keydown",n=>{n.code==="Enter"&&U()});z.addEventListener("click",()=>{R(automata),g.clear()});W.addEventListener("click",()=>{x||(K(),B())});J.addEventListener("click",()=>{s=Array(200).fill(""),L(A.value,s)});G.addEventListener("click",F);
